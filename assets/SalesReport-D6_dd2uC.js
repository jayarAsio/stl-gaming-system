import{r as i,j as e,L as ie}from"./index-C0RggB8b.js";const re=({commissionRate:x=.05,games:k=["STL Pares","Last 2","Last 3","Swer3"]})=>{const[o,$]=i.useState("pending"),[h,P]=i.useState(""),[u,K]=i.useState(""),[v,M]=i.useState(!1),[p,z]=i.useState({totalSales:0,totalTickets:0,totalCommission:0,games:[],days:[]}),[S,R]=i.useState({show:!1,message:"",type:"success"}),[w,A]=i.useState(""),[E,y]=i.useState(null),[U,F]=i.useState(!1),[I,Q]=i.useState([]),_={TKT87654321:{ref:"TKT87654321",date:"Jan 15, 2025 2:30 PM",status:"paid",customer:"Juan Dela Cruz",totalAmount:150,commission:7.5,bets:[{game:"STL Pares",combo:"12.34",amount:50},{game:"Last 2",combo:"56",amount:50},{game:"Swer3",combo:"789",amount:50}],drawResults:{"STL Pares":{result:"12.34",status:"won",payout:500},"Last 2":{result:"45",status:"lost",payout:0},Swer3:{result:"123",status:"lost",payout:0}}},TKT98765432:{ref:"TKT98765432",date:"Jan 15, 2025 1:45 PM",status:"paid",customer:"Maria Santos",totalAmount:200,commission:10,bets:[{game:"Last 3",combo:"123",amount:100},{game:"STL Pares",combo:"05.17",amount:100}],drawResults:{"Last 3":{result:"456",status:"lost",payout:0},"STL Pares":{result:"05.17",status:"won",payout:800}}},TKT11223344:{ref:"TKT11223344",date:"Jan 14, 2025 3:15 PM",status:"paid",customer:"Pedro Garcia",totalAmount:150,commission:7.5,bets:[{game:"Last 2",combo:"88",amount:75},{game:"Swer3",combo:"555",amount:75}],drawResults:{"Last 2":{result:"88",status:"won",payout:750},Swer3:{result:"555",status:"won",payout:3750}}},TKT55667788:{ref:"TKT55667788",date:"Jan 14, 2025 11:30 AM",status:"paid",customer:"Ana Reyes",totalAmount:200,commission:10,bets:[{game:"STL Pares",combo:"99.88",amount:100},{game:"Last 3",combo:"777",amount:100}],drawResults:{"STL Pares":{result:"12.34",status:"lost",payout:0},"Last 3":{result:"777",status:"won",payout:5e3}}}};i.useEffect(()=>{const s=new Date;new Date(s).setDate(s.getDate()-7);const l=(r=>{const N=r.getFullYear(),b=String(r.getMonth()+1).padStart(2,"0"),g=String(r.getDate()).padStart(2,"0");return`${N}-${b}-${g}`})(s);P(l),K(l)},[]),i.useEffect(()=>{h&&u&&B()},[h,u]);const m=i.useCallback((s,a="success")=>{R({show:!0,message:s,type:a}),setTimeout(()=>R(t=>({...t,show:!1})),4e3)},[]),G=i.useCallback((s,a)=>{const t=new Date(s),l=new Date(a),r=Math.floor((l-t)/(1e3*60*60*24))+1,N=[];let b=0,g=0;for(let n=0;n<r;n++){const c=new Date(t);c.setDate(t.getDate()+n);const j=c.getDay()===0||c.getDay()===6?1.3:1,J={date:c.toLocaleDateString("en-PH",{year:"numeric",month:"2-digit",day:"2-digit"}),dayName:c.toLocaleDateString("en-PH",{weekday:"short"}),games:{}};k.forEach(te=>{const le=Math.floor(Math.random()*50)+10,V=Math.floor(le*j),W=Math.floor(Math.random()*30)+20,O=V*W;J.games[te]={tickets:V,sales:O,commission:Math.floor(O*x),averageAmount:W}}),N.push(J)}const se=k.map(n=>{let c=0,d=0;return N.forEach(j=>{c+=j.games[n].tickets,d+=j.games[n].sales}),g+=c,b+=d,{game:n,tickets:c,sales:d,commission:Math.floor(d*x),averageTicketValue:Math.round(d/c),popularity:Math.round(c/g*100)}}),ae=N.map(n=>{let c=0,d=0;return k.forEach(j=>{c+=n.games[j].tickets,d+=n.games[j].sales}),{date:n.date,dayName:n.dayName,tickets:c,sales:d,commission:Math.floor(d*x),averageTicketValue:Math.round(d/c)}});return{totalSales:b,totalTickets:g,totalCommission:Math.floor(b*x),games:se.sort((n,c)=>c.sales-n.sales),days:ae.sort((n,c)=>new Date(c.date)-new Date(n.date))}},[k,x]),B=i.useCallback(async()=>{if(!h||!u){m("Please select both From and To dates","error");return}if(new Date(h)>new Date(u)){m("From date cannot be later than To date","error");return}M(!0),setTimeout(()=>{const s=G(h,u);z(s),M(!1),m("Sales report generated successfully!","info")},1e3)},[h,u,G,m]),T=i.useCallback(s=>{if(!s)return"";const t=String(s).toUpperCase().replace(/^TKT/i,"").replace(/\D/g,"").slice(0,8);return t?`TKT${t}`:"TKT"},[]),f=i.useCallback(s=>/^TKT\d{8}$/.test(s),[]),D=i.useCallback(async(s=w)=>{const a=T(s);if(!a||a==="TKT"){y(null);return}if(!f(a)){m("Please enter a valid ticket reference (TKT + 8 digits)","error");return}F(!0),Q(t=>{const l=t.filter(r=>r!==a);return[a,...l].slice(0,5)}),setTimeout(()=>{const t=_[a];t?(y(t),m("Ticket found successfully","success")):(y(null),m("Ticket not found","error")),F(!1)},800)},[w,T,f,m]),Y=i.useCallback(s=>{const a=T(s.target.value);A(a),f(a)?D(a):(a==="TKT"||a==="")&&y(null)},[T,f,D]),q=i.useCallback(s=>{m(`Ticket ${s} sent to printer`,"success")},[m]),L=s=>{$(s)},C=s=>{const a=["pending","approved","ticket"],t=a.indexOf(o);let l=t;switch(s.key){case"ArrowRight":l=(t+1)%a.length;break;case"ArrowLeft":l=(t-1+a.length)%a.length;break;case"Home":l=0;break;case"End":l=a.length-1;break;default:return}s.preventDefault(),$(a[l])},X=({game:s,index:a})=>{const l={"STL Pares":"🎯","Last 2":"🎲","Last 3":"🎰",Swer3:"🎪"}[s.game]||"🎮";return e.jsxs("article",{className:"list-card enhanced",role:"listitem","aria-labelledby":`game-${a}-title`,children:[e.jsxs("div",{className:"list-title",children:[e.jsxs("div",{className:"list-name",id:`game-${a}-title`,children:[e.jsx("span",{"aria-hidden":"true",children:l}),e.jsxs("div",{children:[e.jsx("div",{className:"name-text",children:s.game}),e.jsxs("div",{className:"popularity",children:[s.popularity,"% of total volume"]})]})]}),e.jsx("div",{className:"badge-group",children:e.jsxs("span",{className:"badge primary",children:[s.tickets.toLocaleString()," tickets"]})})]}),e.jsxs("div",{className:"list-stats enhanced",children:[e.jsxs("div",{className:"stat",children:[e.jsx("div",{className:"stat-label",children:"Total Sales"}),e.jsxs("div",{className:"stat-value amount",children:["₱",s.sales.toLocaleString()]})]}),e.jsxs("div",{className:"stat",children:[e.jsx("div",{className:"stat-label",children:"Commission"}),e.jsxs("div",{className:"stat-value commission",children:["₱",s.commission.toLocaleString()]})]}),e.jsxs("div",{className:"stat",children:[e.jsx("div",{className:"stat-label",children:"Avg Ticket"}),e.jsxs("div",{className:"stat-value average",children:["₱",s.averageTicketValue]})]})]})]})},Z=({day:s,index:a})=>e.jsxs("article",{className:"list-card enhanced",role:"listitem","aria-labelledby":`day-${a}-title`,children:[e.jsxs("div",{className:"list-title",children:[e.jsxs("div",{className:"list-name",id:`day-${a}-title`,children:[e.jsx("span",{"aria-hidden":"true",children:"📅"}),e.jsxs("div",{children:[e.jsx("div",{className:"name-text",children:s.date}),e.jsx("div",{className:"day-name",children:s.dayName})]})]}),e.jsx("div",{className:"badge-group",children:e.jsxs("span",{className:"badge primary",children:[s.tickets.toLocaleString()," tickets"]})})]}),e.jsxs("div",{className:"list-stats enhanced",children:[e.jsxs("div",{className:"stat",children:[e.jsx("div",{className:"stat-label",children:"Total Sales"}),e.jsxs("div",{className:"stat-value amount",children:["₱",s.sales.toLocaleString()]})]}),e.jsxs("div",{className:"stat",children:[e.jsx("div",{className:"stat-label",children:"Commission"}),e.jsxs("div",{className:"stat-value commission",children:["₱",s.commission.toLocaleString()]})]}),e.jsxs("div",{className:"stat",children:[e.jsx("div",{className:"stat-label",children:"Avg Ticket"}),e.jsxs("div",{className:"stat-value average",children:["₱",s.averageTicketValue]})]})]})]}),ee=({ticket:s})=>{if(!s)return null;const a=Object.values(s.drawResults).reduce((l,r)=>l+r.payout,0),t=a>0;return e.jsxs("div",{className:"ticket-details",children:[e.jsxs("div",{className:"ticket-header",children:[e.jsxs("div",{className:"ticket-info",children:[e.jsx("h3",{children:s.ref}),e.jsxs("div",{className:"ticket-meta",children:[e.jsx("div",{className:"ticket-date",children:s.date}),e.jsxs("div",{className:"ticket-customer",children:["Customer: ",s.customer]})]})]}),e.jsx("div",{className:`ticket-status ${s.status}`,children:s.status.toUpperCase()})]}),e.jsxs("div",{className:"ticket-bets",children:[e.jsx("h4",{children:"Bets Placed"}),s.bets.map((l,r)=>e.jsxs("div",{className:"bet-item",children:[e.jsx("div",{className:"bet-game",children:l.game}),e.jsx("div",{className:"bet-combo",children:l.combo}),e.jsxs("div",{className:"bet-amount",children:["₱",l.amount]})]},r))]}),e.jsxs("div",{className:"ticket-results",children:[e.jsx("h4",{children:"Draw Results"}),Object.entries(s.drawResults).map(([l,r])=>e.jsxs("div",{className:`result-item ${r.status}`,children:[e.jsx("div",{className:"result-game",children:l}),e.jsx("div",{className:"result-numbers",children:r.result}),e.jsxs("div",{className:"result-status",children:[e.jsx("span",{className:`status-badge ${r.status}`,children:r.status.toUpperCase()}),r.payout>0&&e.jsxs("span",{className:"payout",children:["₱",r.payout.toLocaleString()]})]})]},l))]}),e.jsxs("div",{className:"ticket-summary",children:[e.jsxs("div",{className:"summary-row",children:[e.jsx("span",{children:"Total Bet Amount"}),e.jsxs("span",{children:["₱",s.totalAmount.toLocaleString()]})]}),e.jsxs("div",{className:"summary-row",children:[e.jsx("span",{children:"Commission Earned"}),e.jsxs("span",{className:"commission",children:["₱",s.commission.toLocaleString()]})]}),t&&e.jsxs("div",{className:"summary-row winning",children:[e.jsx("span",{children:"Total Payout"}),e.jsxs("span",{children:["₱",a.toLocaleString()]})]})]}),e.jsx("div",{className:"ticket-actions",children:e.jsxs("button",{className:"btn btn-primary",onClick:()=>q(s.ref),children:[e.jsx("span",{children:"🖨️"}),"Reprint Ticket"]})})]})},H=({icon:s,title:a,text:t})=>e.jsxs("div",{className:"empty-card",role:"status",children:[e.jsx("div",{className:"empty-icon",children:s}),e.jsx("div",{className:"empty-title",children:a}),e.jsx("div",{className:"empty-text",children:t})]});return e.jsxs("div",{className:"container",children:[e.jsxs("header",{className:"header",children:[e.jsxs("div",{className:"header-content",children:[e.jsx("h1",{children:"Sales Report"}),e.jsx("p",{className:"header-subtitle",children:"Advanced analytics and ticket management"})]}),e.jsxs(ie,{to:"/teller",className:"back-btn","aria-label":"Back to Dashboard",children:[e.jsx("span",{"aria-hidden":"true",children:"←"})," Back To Dashboard"]})]}),e.jsxs("section",{className:"card summary-section","aria-labelledby":"summary-title",children:[e.jsxs("h2",{id:"summary-title",children:[e.jsx("span",{className:"summary-icon",children:"📊"}),"Performance Overview"]}),e.jsxs("div",{className:"summary-grid",children:[e.jsxs("div",{className:"summary-card",children:[e.jsxs("div",{className:"summary-value",children:["₱",p.totalSales.toLocaleString()]}),e.jsx("div",{className:"summary-label",children:"Total Sales"})]}),e.jsxs("div",{className:"summary-card",children:[e.jsx("div",{className:"summary-value",children:p.totalTickets.toLocaleString()}),e.jsx("div",{className:"summary-label",children:"Total Tickets"})]}),e.jsxs("div",{className:"summary-card",children:[e.jsxs("div",{className:"summary-value commission-value",children:["₱",p.totalCommission.toLocaleString()]}),e.jsx("div",{className:"summary-label",children:"Total Commission"})]}),e.jsxs("div",{className:"summary-card",children:[e.jsxs("div",{className:"summary-value commission-value",children:[(x*100).toFixed(x*100%1===0?0:2),"%"]}),e.jsx("div",{className:"summary-label",children:"Commission Rate"})]})]})]}),e.jsxs("section",{className:"card controls-section",children:[e.jsx("div",{className:"controls-header",children:e.jsxs("h2",{className:"controls-title",children:[e.jsx("span",{className:"controls-icon",children:"⚙️"}),"Report Controls"]})}),e.jsxs("div",{className:"filter-toolbar simplified",children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("h4",{className:"filter-group-title",children:"Date Range"}),e.jsxs("div",{className:"date-inputs",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"fromDate",className:"form-label",children:"From Date"}),e.jsx("input",{type:"date",id:"fromDate",className:"form-input",value:h,onChange:s=>P(s.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"toDate",className:"form-label",children:"To Date"}),e.jsx("input",{type:"date",id:"toDate",className:"form-input",value:u,onChange:s=>K(s.target.value)})]})]})]}),e.jsx("div",{className:"filter-group",children:e.jsx("button",{className:"btn btn-primary",onClick:B,disabled:v,"aria-busy":v,children:v?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner","aria-hidden":"true"}),"Generating Report..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{"aria-hidden":"true",children:"📊"}),"Generate Report"]})})})]})]}),e.jsxs("section",{className:"card breakdown-section","aria-labelledby":"breakdown-title",children:[e.jsxs("div",{className:"breakdown-header",children:[e.jsxs("h2",{id:"breakdown-title",className:"breakdown-title",children:[e.jsx("span",{className:"breakdown-icon",children:"📈"}),"Sales & Tickets"]}),e.jsx("div",{className:"view-controls",children:e.jsxs("div",{className:"tabs-container",role:"tablist","aria-label":"Sales breakdown tabs",children:[e.jsx("button",{className:"tab-btn",role:"tab",id:"tab-pending","aria-controls":"panel-pending","aria-selected":o==="pending",tabIndex:o==="pending"?0:-1,onClick:()=>L("pending"),onKeyDown:C,children:"By Game Type"}),e.jsx("button",{className:"tab-btn",role:"tab",id:"tab-approved","aria-controls":"panel-approved","aria-selected":o==="approved",tabIndex:o==="approved"?0:-1,onClick:()=>L("approved"),onKeyDown:C,children:"By Date Range"}),e.jsx("button",{className:"tab-btn",role:"tab",id:"tab-ticket","aria-controls":"panel-ticket","aria-selected":o==="ticket",tabIndex:o==="ticket"?0:-1,onClick:()=>L("ticket"),onKeyDown:C,children:"Search Ticket"})]})})]}),(o==="pending"||o==="approved")&&e.jsx("div",{className:"meta-info enhanced",children:e.jsxs("span",{className:"chip",children:[e.jsx("span",{"aria-hidden":"true",children:"📅"}),"Period: ",h&&u?`${h} → ${u}`:"—"]})}),e.jsx("div",{id:"panel-pending",className:`tabpanel ${o==="pending"?"active":""}`,role:"tabpanel","aria-labelledby":"tab-pending",children:e.jsx("div",{className:"list-grid enhanced",role:"list",children:v?Array(3).fill(0).map((s,a)=>e.jsxs("div",{className:"list-card skeleton",children:[e.jsx("div",{className:"skeleton-line title"}),e.jsx("div",{className:"skeleton-line"}),e.jsx("div",{className:"skeleton-line"})]},a)):p.games.length>0?p.games.map((s,a)=>e.jsx(X,{game:s,index:a},`${s.game}-${a}`)):e.jsx(H,{icon:"🔍",title:"No Pending Sales",text:"No pending sales data available for the selected criteria."})})}),e.jsx("div",{id:"panel-approved",className:`tabpanel ${o==="approved"?"active":""}`,role:"tabpanel","aria-labelledby":"tab-approved",children:e.jsx("div",{className:"list-grid enhanced",role:"list",children:v?Array(3).fill(0).map((s,a)=>e.jsxs("div",{className:"list-card skeleton",children:[e.jsx("div",{className:"skeleton-line title"}),e.jsx("div",{className:"skeleton-line"}),e.jsx("div",{className:"skeleton-line"})]},a)):p.days.length>0?p.days.map((s,a)=>e.jsx(Z,{day:s,index:a},`${s.date}-${a}`)):e.jsx(H,{icon:"🔍",title:"No Approved Sales",text:"No approved sales data available for the selected criteria."})})}),e.jsx("div",{id:"panel-ticket",className:`tabpanel ${o==="ticket"?"active":""}`,role:"tabpanel","aria-labelledby":"tab-ticket",children:e.jsxs("div",{className:"ticket-search-section",children:[e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"card-title",children:[e.jsx("span",{className:"card-icon",children:"🔍"}),"Search Ticket"]}),e.jsxs("div",{className:"search-section",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"ticket-search",className:"form-label",children:"Ticket Reference Number"}),e.jsxs("div",{className:"search-input-container",children:[e.jsx("input",{id:"ticket-search",className:"form-input",type:"text",placeholder:"Enter ticket reference (e.g., TKT12345678)",maxLength:11,autoComplete:"off",value:w,onChange:Y}),U&&e.jsx("div",{className:"search-spinner",children:e.jsx("div",{className:"spinner"})})]}),e.jsx("div",{className:"helper",children:"Enter the complete ticket reference number to view details and reprint."})]}),I.length>0&&e.jsxs("div",{className:"search-history",children:[e.jsx("div",{className:"history-label",children:"Recent Searches:"}),e.jsx("div",{className:"history-items",children:I.map(s=>e.jsx("button",{className:"history-item",onClick:()=>{A(s),D(s)},children:s},s))})]})]})]}),E&&e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"card-title",children:[e.jsx("span",{className:"card-icon",children:"🎫"}),"Ticket Details"]}),e.jsx(ee,{ticket:E})]})]})})]}),S.show&&e.jsx("div",{className:`toast show ${S.type}`,role:"status","aria-live":"polite","aria-atomic":"true",children:S.message})]})};export{re as default};
