import{a as i,j as e,L as W}from"./index-AXjc9jp2.js";/* empty css               */const U={TKT87654321:{ref:"TKT87654321",date:"Jan 15, 2025 2:30 PM",status:"valid",timeLeft:25,bets:[{game:"STL Pares",combo:"12.34",amount:50},{game:"Last 2",combo:"56",amount:50},{game:"Swer3",combo:"789",amount:50}],total:150},TKT98765432:{ref:"TKT98765432",date:"Jan 15, 2025 1:45 PM",status:"valid",timeLeft:5,bets:[{game:"Last 3",combo:"123",amount:100},{game:"STL Pares",combo:"05.17",amount:100}],total:200},TKT11223344:{ref:"TKT11223344",date:"Jan 15, 2025 12:15 PM",status:"expired",timeLeft:0,bets:[{game:"Last 2",combo:"42",amount:75}],total:75},TKT55667788:{ref:"TKT55667788",date:"Jan 15, 2025 10:00 AM",status:"draw-locked",timeLeft:0,bets:[{game:"STL Pares",combo:"25.08",amount:150},{game:"Last 3",combo:"456",amount:150}],total:300}},B=[{ref:"TKT87654321",dt:"Jan 15, 2:30 PM",amount:150,bets:3},{ref:"TKT98765432",dt:"Jan 15, 1:45 PM",amount:200,bets:2},{ref:"TKT11223344",dt:"Jan 15, 12:15 PM",amount:75,bets:1},{ref:"TKT55667788",dt:"Jan 15, 10:00 AM",amount:300,bets:4}],z={pending:[{id:"VR789012",submitted:"Jan 15, 3:15 PM",status_note:"Awaiting supervisor approval",reason:"Wrong combination entered",description:"Customer requested different numbers after ticket was printed. Need to void and create new ticket with correct combination.",priority:"high",ticket:{ref:"TKT87654321",details_html:"Jan 15, 2:30 PM ‚Ä¢ ‚Ç±150<br>STL Pares: 12.34 ‚Ä¢ Last 2: 56 ‚Ä¢ Swer3: 789"}},{id:"VR789013",submitted:"Jan 15, 1:50 PM",status_note:"Under review",reason:"Wrong bet amount",description:"Entered ‚Ç±100 instead of ‚Ç±50 for Last 3 bet. Customer noticed immediately after transaction.",priority:"medium",ticket:{ref:"TKT98765432",details_html:"Jan 15, 1:45 PM ‚Ä¢ ‚Ç±200<br>Last 3: 123 ‚Ä¢ STL Pares: 05.17"}}],approved:[{id:"VR789010",approved_at:"Jan 15, 11:45 AM",approved_by:"Supervisor M. Santos",reason:"System error",description:"Terminal froze during transaction and printed duplicate ticket. Original transaction was successful.",ticket:{ref:"TKT11223344 (VOIDED)",details_html:"Jan 15, 11:15 AM ‚Ä¢ ‚Ç±75<br>Last 2: 42"}}],rejected:[{id:"VR789009",rejected_at:"Jan 14, 6:15 PM",rejected_by:"Supervisor M. Santos",reason:"Draw time restriction",description:"Request submitted after 2:00 PM draw time for STL Pares. Policy prohibits voids after draw has started.",ticket:{ref:"TKT99887766 (ACTIVE)",details_html:"Jan 14, 1:30 PM ‚Ä¢ ‚Ç±125<br>STL Pares: 20.15 ‚Ä¢ Draw: 2:00 PM"}}]},G=()=>{const[c,T]=i.useState("create"),[k,v]=i.useState(""),[n,h]=i.useState(null),[l,R]=i.useState(""),[u,L]=i.useState(""),[V,C]=i.useState(!1),[y,P]=i.useState(!1),[w,D]=i.useState({show:!1,message:"",type:"success"}),[d,K]=i.useState(z),[_,q]=i.useState([]),p=i.useMemo(()=>new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",maximumFractionDigits:0}),[]),o=i.useCallback((s,t="success")=>{D({show:!0,message:s,type:t}),setTimeout(()=>D(a=>({...a,show:!1})),4e3)},[]),x=i.useCallback(s=>{if(!s)return"";const a=String(s).toUpperCase().replace(/^TKT/i,"").replace(/\D/g,"").slice(0,8);return a?`TKT${a}`:"TKT"},[]),b=i.useCallback(s=>/^TKT\d{8}$/.test(s),[]),$=i.useMemo(()=>{const t=[...d.pending,...d.approved,...d.rejected].length,a=d.approved.length;return{totalRequests:t,approvedCount:a}},[d]),j=i.useCallback(async(s=k)=>{const t=x(s);if(!t||t==="TKT"){h(null);return}if(!b(t)){o("Please enter a valid ticket reference (TKT + 8 digits)","error");return}C(!0),q(a=>{const r=a.filter(m=>m!==t);return[t,...r].slice(0,5)}),setTimeout(()=>{const a=U[t];a?(h(a),o("Ticket found successfully","success")):(h(null),o("Ticket not found","error")),C(!1)},800)},[k,x,b,o]),A=i.useCallback(s=>{const t=x(s.target.value);v(t),b(t)?j(t):(t==="TKT"||t==="")&&h(null)},[x,b,j]),S=i.useMemo(()=>!(!n||n.status!=="valid"||n.timeLeft<=0||!l||l==="other"&&u.trim().length<10),[n,l,u]),I=i.useCallback(async()=>{S&&(P(!0),setTimeout(()=>{const s={id:`VR${Date.now().toString().slice(-6)}`,submitted:new Date().toLocaleString("en-PH",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}),status_note:"Awaiting supervisor approval",reason:l==="other"?"Other":l.replace(/_/g," "),description:u||"No additional details provided",priority:n.timeLeft<=10?"high":"medium",ticket:{ref:n.ref,details_html:`${n.date.split(" ").slice(0,3).join(" ")} ‚Ä¢ ${p.format(n.total)}<br>${n.bets.map(t=>`${t.game}: ${t.combo}`).join(" ‚Ä¢ ")}`}};K(t=>({...t,pending:[s,...t.pending]})),v(""),h(null),R(""),L(""),o(`Void request submitted! ID: ${s.id}`,"success"),T("pending"),P(!1)},1200))},[S,l,u,n,p,o]),J=i.useCallback(s=>{window.confirm("Are you sure you want to cancel this void request?")&&(K(t=>({...t,pending:t.pending.filter(a=>a.id!==s)})),o(`Void request ${s} cancelled`,"info"))},[o]),g=s=>{T(s)},f=s=>{const t=["create","pending","approved","rejected"],a=t.indexOf(c);let r=a;switch(s.key){case"ArrowRight":r=(a+1)%t.length;break;case"ArrowLeft":r=(a-1+t.length)%t.length;break;case"Home":r=0;break;case"End":r=t.length-1;break;default:return}s.preventDefault(),T(t[r])},E=s=>{if(!s)return null;switch(s.status){case"expired":return{type:"expired",icon:"‚è∞",message:"Ticket expired ‚Äî 30-minute void window has passed"};case"draw-locked":return{type:"expired",icon:"üö´",message:"Draw time has passed ‚Äî ticket cannot be voided"};case"valid":return s.timeLeft<=10?{type:"warn",icon:"‚ö†Ô∏è",message:`Urgent: Only ${s.timeLeft} minute${s.timeLeft===1?"":"s"} left to void this ticket!`}:{type:"valid",icon:"‚úÖ",message:`${s.timeLeft} minute${s.timeLeft===1?"":"s"} remaining for void request`};default:return null}},O=()=>e.jsxs("div",{className:"statistics-grid",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-value",children:$.totalRequests}),e.jsx("div",{className:"stat-label",children:"Total Requests"})]}),e.jsxs("div",{className:"stat-card approved",children:[e.jsx("div",{className:"stat-value",children:$.approvedCount}),e.jsx("div",{className:"stat-label",children:"Approved"})]})]}),H=({ticket:s})=>{if(!s)return null;const a={valid:{class:"status-valid",text:"VALID"},void:{class:"status-void",text:"VOIDED"},expired:{class:"status-expired",text:"EXPIRED"},"draw-locked":{class:"status-locked",text:"LOCKED"}}[s.status]||{class:"status-valid",text:"UNKNOWN"},r=E(s);return e.jsxs("div",{className:"ticket-display",children:[e.jsxs("div",{className:"ticket-header",children:[e.jsxs("div",{className:"ticket-info",children:[e.jsx("h3",{children:s.ref}),e.jsx("div",{className:"ticket-date",children:s.date})]}),e.jsx("div",{className:`ticket-status ${a.class}`,children:a.text})]}),e.jsx("div",{className:"ticket-bets",children:s.bets.map((m,M)=>e.jsxs("div",{className:"bet-item",children:[e.jsx("span",{className:"bet-game",children:m.game}),e.jsx("span",{className:"bet-combo",children:m.combo}),e.jsx("span",{className:"bet-amount",children:p.format(m.amount)})]},M))}),e.jsxs("div",{className:"ticket-total",children:[e.jsx("span",{children:"TOTAL AMOUNT"}),e.jsx("span",{children:p.format(s.total)})]}),r&&e.jsxs("div",{className:`time-warning ${r.type}`,children:[e.jsx("span",{children:r.icon}),e.jsx("span",{children:r.message})]})]})},F=({request:s,status:t,onCancel:a})=>{const r=m=>{if(!m)return null;const N={high:{class:"priority-high",text:"HIGH",icon:"üî•"},medium:{class:"priority-medium",text:"MED",icon:"‚ö°"},low:{class:"priority-low",text:"LOW",icon:"üìù"}}[m];return N?e.jsxs("div",{className:`priority-badge ${N.class}`,children:[e.jsx("span",{children:N.icon})," ",N.text]}):null};return e.jsxs("article",{className:`void-item ${t}`,children:[e.jsxs("div",{className:"void-header",children:[e.jsxs("div",{className:"void-info",children:[e.jsxs("div",{className:"void-title-row",children:[e.jsxs("h4",{children:["Void Request #",s.id]}),r(s.priority)]}),e.jsxs("div",{className:"void-meta",children:[s.submitted&&`Submitted: ${s.submitted}`,s.approved_at&&`Approved: ${s.approved_at}`,s.rejected_at&&`Rejected: ${s.rejected_at}`,e.jsx("br",{}),s.status_note&&`Status: ${s.status_note}`,s.approved_by&&`By: ${s.approved_by}`,s.rejected_by&&`By: ${s.rejected_by}`]})]}),e.jsx("div",{className:`void-status status-${t}`,children:t.toUpperCase()})]}),e.jsxs("div",{className:"void-details",children:[e.jsx("div",{className:"void-reason",children:s.reason}),e.jsx("div",{className:"void-description",children:s.description})]}),e.jsxs("div",{className:"void-ticket-info",children:[e.jsxs("div",{className:"void-ticket-ref",children:["Ticket: ",s.ticket.ref]}),e.jsx("div",{className:"void-ticket-details",dangerouslySetInnerHTML:{__html:s.ticket.details_html}})]}),t==="pending"&&a&&e.jsxs("button",{className:"btn btn-danger btn-block cancel-request-btn",onClick:()=>a(s.id),children:[e.jsx("span",{"aria-hidden":"true",children:"‚ùå"}),"Cancel Request"]})]})};return e.jsxs("div",{className:"container",children:[e.jsxs("header",{className:"header",children:[e.jsxs("div",{className:"content",children:[e.jsx("h1",{children:"Void Request Management"}),e.jsx("p",{children:"Manage ticket void requests and track their status"})]}),e.jsxs(W,{to:"/teller",className:"back-button","aria-label":"Back to Dashboard",children:[e.jsx("span",{"aria-hidden":"true",children:"‚Üê"})," Back To Dashboard"]})]}),e.jsxs("section",{className:"card statistics-section",children:[e.jsxs("h2",{className:"section-title",children:[e.jsx("span",{className:"section-icon",children:"üìä"}),"Request Statistics"]}),e.jsx(O,{})]}),e.jsx("div",{className:"tabs-container",children:e.jsxs("div",{className:"tabs",role:"tablist","aria-label":"Void Request sections",children:[e.jsx("button",{className:"tab-btn",role:"tab",id:"tab-create","aria-controls":"panel-create","aria-selected":c==="create",tabIndex:c==="create"?0:-1,onClick:()=>g("create"),onKeyDown:f,children:"Create New Request"}),e.jsxs("button",{className:"tab-btn",role:"tab",id:"tab-pending","aria-controls":"panel-pending","aria-selected":c==="pending",tabIndex:c==="pending"?0:-1,onClick:()=>g("pending"),onKeyDown:f,children:["Pending (",d.pending.length,")"]}),e.jsxs("button",{className:"tab-btn",role:"tab",id:"tab-approved","aria-controls":"panel-approved","aria-selected":c==="approved",tabIndex:c==="approved"?0:-1,onClick:()=>g("approved"),onKeyDown:f,children:["Approved (",d.approved.length,")"]}),e.jsxs("button",{className:"tab-btn",role:"tab",id:"tab-rejected","aria-controls":"panel-rejected","aria-selected":c==="rejected",tabIndex:c==="rejected"?0:-1,onClick:()=>g("rejected"),onKeyDown:f,children:["Rejected (",d.rejected.length,")"]})]})}),e.jsxs("main",{children:[e.jsxs("div",{className:`tabpanel ${c==="create"?"active":""}`,children:[e.jsxs("div",{className:"card",children:[e.jsxs("h2",{className:"card-title",children:[e.jsx("span",{className:"card-icon",children:"üîç"}),"Search Ticket"]}),e.jsxs("div",{className:"search-section",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"ticket-ref",className:"form-label",children:"Ticket Reference Number"}),e.jsxs("div",{className:"search-input-container",children:[e.jsx("input",{id:"ticket-ref",className:"form-input",type:"text",placeholder:"Enter ticket reference (e.g., TKT12345678)",maxLength:11,autoComplete:"off",value:k,onChange:A}),V&&e.jsx("div",{className:"search-spinner",children:e.jsx("div",{className:"spinner"})})]}),e.jsx("div",{className:"helper",children:"Enter the complete ticket reference number to search for eligible tickets."})]}),_.length>0&&e.jsxs("div",{className:"search-history",children:[e.jsx("div",{className:"history-label",children:"Recent Searches:"}),e.jsx("div",{className:"history-items",children:_.map(s=>e.jsx("button",{className:"history-item",onClick:()=>{v(s),j(s)},children:s},s))})]})]})]}),n&&e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"card-title",children:[e.jsx("span",{className:"card-icon",children:"üé´"}),"Ticket Details"]}),e.jsx(H,{ticket:n})]}),n&&n.status==="valid"&&n.timeLeft>0&&e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"card-title",children:[e.jsx("span",{className:"card-icon",children:"üìã"}),"Submit Void Request"]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"void-reason",className:"form-label",children:"Reason for Void Request"}),e.jsxs("select",{id:"void-reason",className:"form-select",value:l,onChange:s=>R(s.target.value),children:[e.jsx("option",{value:"",children:"Select a reason..."}),e.jsx("option",{value:"wrong_combination",children:"Wrong combination entered"}),e.jsx("option",{value:"wrong_amount",children:"Wrong bet amount"}),e.jsx("option",{value:"duplicate_entry",children:"Duplicate entry"}),e.jsx("option",{value:"customer_request",children:"Customer request"}),e.jsx("option",{value:"system_error",children:"System error"}),e.jsx("option",{value:"other",children:"Other (please specify)"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"void-details",className:"form-label",children:"Additional Details"}),e.jsx("textarea",{id:"void-details",className:"form-textarea",placeholder:"Provide additional details about the void request...",maxLength:500,value:u,onChange:s=>L(s.target.value)}),e.jsx("div",{className:"helper",children:l==="other"?`Required: Provide more context (${u.length}/500 characters, minimum 10)`:`Optional: Provide more context to help supervisors process your request (${u.length}/500 characters)`})]}),e.jsx("button",{className:"btn btn-warning btn-block",onClick:I,disabled:!S||y,"aria-busy":y,children:y?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner","aria-hidden":"true"}),"Submitting Request..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{"aria-hidden":"true",children:"üì§"}),"Submit Void Request"]})})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"card-title",children:[e.jsx("span",{className:"card-icon",children:"üìö"}),"Recent Tickets"]}),e.jsx("p",{className:"helper",style:{marginBottom:"var(--spacing-lg)"},children:"Click on any recent ticket to quickly search for it"}),e.jsx("div",{className:"recent-grid",children:B.map(s=>e.jsxs("button",{className:"recent-item",onClick:()=>{v(s.ref),j(s.ref)},children:[e.jsx("div",{className:"recent-ref",children:s.ref}),e.jsxs("div",{className:"recent-details",children:[s.dt,e.jsx("br",{}),p.format(s.amount)," ‚Ä¢ ",s.bets," ",s.bets===1?"bet":"bets"]})]},s.ref))})]})]}),["pending","approved","rejected"].map(s=>e.jsx("div",{className:`tabpanel ${c===s?"active":""}`,children:d[s].length===0?e.jsxs("div",{className:"empty-state",children:[e.jsxs("div",{className:"empty-icon",children:[s==="pending"&&"‚è≥",s==="approved"&&"‚úÖ",s==="rejected"&&"‚ùå"]}),e.jsxs("div",{className:"empty-title",children:["No ",s==="pending"?"Pending":s.charAt(0).toUpperCase()+s.slice(1)," Requests"]}),e.jsx("div",{className:"empty-text",children:s==="pending"?"You don't have any pending void requests at the moment.":`Your ${s} void requests will appear here.`})]}):d[s].map(t=>e.jsx(F,{request:t,status:s,onCancel:s==="pending"?J:null},t.id))},s))]}),w.show&&e.jsx("div",{className:`toast show ${w.type}`,role:"status","aria-live":"polite","aria-atomic":"true",children:w.message})]})};export{G as default};
