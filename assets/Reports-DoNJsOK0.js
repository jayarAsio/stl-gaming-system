import{r as n,j as e,L as G}from"./index-tHYtu1G2.js";const g={collections:[{tellerId:"T001",tellerName:"Juan Dela Cruz",tellerCode:"TLR001",location:"Booth A1",date:"2025-01-15",totalSales:25420,totalWinners:8650,grossSurplus:16770,commission:1271,netCollected:15499,collectedAt:"2025-01-15 02:30 PM",collectedBy:"Collector C001"},{tellerId:"T003",tellerName:"Pedro Garcia",tellerCode:"TLR003",location:"Booth C3",date:"2025-01-15",totalSales:32750,totalWinners:18900,grossSurplus:13850,commission:1637.5,netCollected:12212.5,collectedAt:"2025-01-15 01:45 PM",collectedBy:"Collector C001"},{tellerId:"T007",tellerName:"Miguel Fernandez",tellerCode:"TLR007",location:"Booth G7",date:"2025-01-15",totalSales:2850,totalWinners:0,grossSurplus:2850,commission:142.5,netCollected:2707.5,collectedAt:"2025-01-15 03:15 PM",collectedBy:"Collector C001"}],payouts:[{tellerId:"T004",tellerName:"Ana Reyes",tellerCode:"TLR004",location:"Booth D4",date:"2025-01-15",totalSales:31200,totalWinners:45600,shortage:14400,payoutAmount:14400,processedAt:"2025-01-15 01:30 PM",processedBy:"Collector C001",reason:"insufficient_funds"},{tellerId:"T002",tellerName:"Maria Santos",tellerCode:"TLR002",location:"Booth B2",date:"2025-01-15",totalSales:18150,totalWinners:28350,shortage:10200,payoutAmount:10200,processedAt:"2025-01-15 10:45 AM",processedBy:"Collector C001",reason:"multiple_winners"}]},F=()=>{const[i,T]=n.useState("combined"),[o,N]=n.useState({from:"",to:""}),[c,v]=n.useState([]),[f,b]=n.useState(!1),[h,P]=n.useState(null),[R,C]=n.useState(!1),[y,_]=n.useState({show:!1,message:"",type:"success"});n.useEffect(()=>{const s=new Date().toISOString().split("T")[0];N({from:s,to:s})},[]),n.useEffect(()=>(document.body.classList.add("reports-module-bg"),()=>document.body.classList.remove("reports-module-bg")),[]);const a=new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",maximumFractionDigits:2}),m=n.useCallback((s,t="success")=>{_({show:!0,message:s,type:t}),setTimeout(()=>_(l=>({...l,show:!1})),4e3)},[]),S=n.useMemo(()=>{const s=new Set;return g.collections.forEach(t=>s.add(`${t.tellerId}:${t.tellerName}`)),g.payouts.forEach(t=>s.add(`${t.tellerId}:${t.tellerName}`)),Array.from(s).map(t=>{const[l,r]=t.split(":");return{id:l,name:r}})},[]),p=n.useMemo(()=>{const s=g.collections.filter(l=>{const r=!o.from||!o.to||l.date>=o.from&&l.date<=o.to,x=c.length===0||c.includes(l.tellerId);return r&&x}),t=g.payouts.filter(l=>{const r=!o.from||!o.to||l.date>=o.from&&l.date<=o.to,x=c.length===0||c.includes(l.tellerId);return r&&x});return{collections:s,payouts:t}},[o,c]),d=n.useMemo(()=>{const{collections:s,payouts:t}=p,l=s.reduce((u,j)=>u+j.netCollected,0),r=t.reduce((u,j)=>u+j.payoutAmount,0),x=s.reduce((u,j)=>u+j.commission,0),B=l-r;return{totalCollections:l,totalPayouts:r,totalCommission:x,netPosition:B,collectionsCount:s.length,payoutsCount:t.length,totalTransactions:s.length+t.length}},[p]),w=n.useCallback(s=>{v(t=>t.includes(s)?t.filter(l=>l!==s):[...t,s])},[]),A=n.useCallback(async()=>{if(!o.from||!o.to){m("Please select date range","error");return}b(!0),setTimeout(()=>{const s={id:`RPT${Date.now().toString().slice(-8)}`,type:i,dateRange:o,selectedTellers:c.length||"All Tellers",data:p,stats:d,generatedAt:new Date().toISOString(),generatedBy:"Collector C001"};P(s),b(!1),C(!0),m("Report generated successfully","success")},2e3)},[i,o,c,p,d,m]),k=n.useCallback(()=>{h&&(m("PDF export started - check downloads folder","success"),setTimeout(()=>{const s=new Blob(["PDF content would be here"],{type:"application/pdf"}),t=URL.createObjectURL(s),l=document.createElement("a");l.href=t,l.download=`${h.type}-report-${h.id}.pdf`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(t),m("PDF downloaded successfully","success")},1e3))},[h,m]),D=()=>e.jsxs("div",{className:"statistics-grid",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-value",children:d.totalTransactions}),e.jsx("div",{className:"stat-label",children:"Total Transactions"})]}),e.jsxs("div",{className:"stat-card collections",children:[e.jsx("div",{className:"stat-value",children:a.format(d.totalCollections)}),e.jsx("div",{className:"stat-label",children:"Total Collections"})]}),e.jsxs("div",{className:"stat-card payouts",children:[e.jsx("div",{className:"stat-value",children:a.format(d.totalPayouts)}),e.jsx("div",{className:"stat-label",children:"Total Payouts"})]}),e.jsxs("div",{className:"stat-card net",children:[e.jsx("div",{className:"stat-value",children:a.format(Math.abs(d.netPosition))}),e.jsx("div",{className:"stat-label",children:d.netPosition>=0?"Net Gain":"Net Loss"})]})]}),L=({report:s})=>s?e.jsxs("div",{className:"report-preview",children:[e.jsxs("div",{className:"report-header",children:[e.jsxs("div",{className:"company-header",children:[e.jsx("h1",{children:"STL Gaming System"}),e.jsx("p",{children:"PCSO Licensed Gaming Operator"}),e.jsx("p",{children:"Collector Financial Report"})]}),e.jsxs("div",{className:"report-meta",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Report ID:"})," ",s.id]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Type:"})," ",s.type.toUpperCase()]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Period:"})," ",s.dateRange.from," to ",s.dateRange.to]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Generated:"})," ",new Date(s.generatedAt).toLocaleString("en-PH")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Generated By:"})," ",s.generatedBy]})]})]}),e.jsxs("div",{className:"report-summary",children:[e.jsx("h2",{children:"Executive Summary"}),e.jsxs("div",{className:"summary-grid",children:[e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{children:"Total Collections:"}),e.jsx("span",{className:"amount positive",children:a.format(s.stats.totalCollections)})]}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{children:"Total Payouts:"}),e.jsx("span",{className:"amount negative",children:a.format(s.stats.totalPayouts)})]}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{children:"Commission Earned:"}),e.jsx("span",{className:"amount",children:a.format(s.stats.totalCommission)})]}),e.jsxs("div",{className:"summary-item total",children:[e.jsx("span",{children:"Net Position:"}),e.jsxs("span",{className:`amount ${s.stats.netPosition>=0?"positive":"negative"}`,children:[s.stats.netPosition>=0?"+":"",a.format(s.stats.netPosition)]})]})]})]}),(i==="collections"||i==="combined")&&s.data.collections.length>0&&e.jsxs("div",{className:"report-section",children:[e.jsx("h2",{children:"Collections Report"}),e.jsx("div",{className:"data-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Teller"}),e.jsx("th",{children:"Location"}),e.jsx("th",{children:"Total Sales"}),e.jsx("th",{children:"Winners"}),e.jsx("th",{children:"Gross Surplus"}),e.jsx("th",{children:"Commission"}),e.jsx("th",{children:"Net Collected"}),e.jsx("th",{children:"Collected At"})]})}),e.jsx("tbody",{children:s.data.collections.map((t,l)=>e.jsxs("tr",{children:[e.jsxs("td",{children:[t.tellerName," (",t.tellerCode,")"]}),e.jsx("td",{children:t.location}),e.jsx("td",{children:a.format(t.totalSales)}),e.jsx("td",{children:a.format(t.totalWinners)}),e.jsx("td",{children:a.format(t.grossSurplus)}),e.jsx("td",{children:a.format(t.commission)}),e.jsx("td",{className:"amount positive",children:a.format(t.netCollected)}),e.jsx("td",{children:t.collectedAt})]},l))}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"total-row",children:[e.jsx("td",{colSpan:"6",children:e.jsx("strong",{children:"Total Collections:"})}),e.jsx("td",{className:"amount positive",children:e.jsx("strong",{children:a.format(s.data.collections.reduce((t,l)=>t+l.netCollected,0))})}),e.jsx("td",{})]})})]})})]}),(i==="payouts"||i==="combined")&&s.data.payouts.length>0&&e.jsxs("div",{className:"report-section",children:[e.jsx("h2",{children:"Payouts Report"}),e.jsx("div",{className:"data-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Teller"}),e.jsx("th",{children:"Location"}),e.jsx("th",{children:"Total Sales"}),e.jsx("th",{children:"Winners"}),e.jsx("th",{children:"Shortage"}),e.jsx("th",{children:"Payout Amount"}),e.jsx("th",{children:"Reason"}),e.jsx("th",{children:"Processed At"})]})}),e.jsx("tbody",{children:s.data.payouts.map((t,l)=>e.jsxs("tr",{children:[e.jsxs("td",{children:[t.tellerName," (",t.tellerCode,")"]}),e.jsx("td",{children:t.location}),e.jsx("td",{children:a.format(t.totalSales)}),e.jsx("td",{children:a.format(t.totalWinners)}),e.jsx("td",{children:a.format(t.shortage)}),e.jsx("td",{className:"amount negative",children:a.format(t.payoutAmount)}),e.jsx("td",{children:t.reason.replace(/_/g," ").toUpperCase()}),e.jsx("td",{children:t.processedAt})]},l))}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"total-row",children:[e.jsx("td",{colSpan:"5",children:e.jsx("strong",{children:"Total Payouts:"})}),e.jsx("td",{className:"amount negative",children:e.jsx("strong",{children:a.format(s.data.payouts.reduce((t,l)=>t+l.payoutAmount,0))})}),e.jsx("td",{colSpan:"2"})]})})]})})]}),e.jsxs("div",{className:"report-footer",children:[e.jsx("p",{children:e.jsx("strong",{children:"Report Notes:"})}),e.jsxs("ul",{children:[e.jsx("li",{children:"All amounts are in Philippine Peso (PHP)"}),e.jsx("li",{children:"Collections represent surplus amounts after winner payouts"}),e.jsx("li",{children:"Payouts represent advances to tellers for insufficient funds"}),e.jsx("li",{children:"Commission rate: 5% of gross sales"}),e.jsx("li",{children:"This report is generated automatically by the STL Gaming System"})]}),e.jsxs("div",{className:"signature-section",children:[e.jsxs("div",{className:"signature",children:[e.jsx("p",{children:"_________________________"}),e.jsx("p",{children:"Collector Signature"})]}),e.jsxs("div",{className:"signature",children:[e.jsx("p",{children:"_________________________"}),e.jsx("p",{children:"Supervisor Approval"})]})]})]})]}):null;return e.jsxs("div",{className:"container",children:[e.jsxs("header",{className:"header",children:[e.jsxs("div",{className:"header-content",children:[e.jsx("h1",{children:"Reports & Analytics"}),e.jsx("p",{className:"header-subtitle",children:"Generate remittance and combined payouts/tapal reports"})]}),e.jsxs(G,{to:"/collector",className:"back-btn","aria-label":"Back to Dashboard",children:[e.jsx("span",{"aria-hidden":"true",children:"←"})," Back To Dashboard"]})]}),e.jsxs("section",{className:"card statistics-section",children:[e.jsxs("h2",{className:"section-title",children:[e.jsx("span",{className:"section-icon",children:"📊"}),"Report Summary"]}),e.jsx(D,{})]}),e.jsxs("section",{className:"card configuration-section",children:[e.jsxs("h2",{className:"section-title",children:[e.jsx("span",{className:"section-icon",children:"⚙️"}),"Report Configuration"]}),e.jsxs("div",{className:"config-grid",children:[e.jsxs("div",{className:"config-group",children:[e.jsx("label",{htmlFor:"report-type",className:"config-label",children:"Report Type"}),e.jsxs("select",{id:"report-type",className:"config-select",value:i,onChange:s=>T(s.target.value),children:[e.jsx("option",{value:"combined",children:"Combined Report"}),e.jsx("option",{value:"collections",children:"Collections Only"}),e.jsx("option",{value:"payouts",children:"Payouts Only"})]})]}),e.jsxs("div",{className:"config-group",children:[e.jsx("label",{htmlFor:"date-from",className:"config-label",children:"From Date"}),e.jsx("input",{id:"date-from",type:"date",className:"config-input",value:o.from,onChange:s=>N(t=>({...t,from:s.target.value}))})]}),e.jsxs("div",{className:"config-group",children:[e.jsx("label",{htmlFor:"date-to",className:"config-label",children:"To Date"}),e.jsx("input",{id:"date-to",type:"date",className:"config-input",value:o.to,onChange:s=>N(t=>({...t,to:s.target.value}))})]})]}),e.jsxs("div",{className:"teller-selection",children:[e.jsx("h3",{className:"selection-title",children:"Select Tellers (Optional)"}),e.jsx("div",{className:"teller-grid",children:S.map(s=>e.jsxs("label",{className:"teller-checkbox",children:[e.jsx("input",{type:"checkbox",checked:c.includes(s.id),onChange:()=>w(s.id)}),e.jsx("span",{className:"checkbox-label",children:s.name})]},s.id))}),e.jsxs("div",{className:"selection-actions",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>v([]),children:"Clear All"}),e.jsx("button",{className:"btn btn-secondary",onClick:()=>v(S.map(s=>s.id)),children:"Select All"})]})]}),e.jsx("div",{className:"generate-section",children:e.jsx("button",{className:"btn btn-primary generate-btn",onClick:A,disabled:f,children:f?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner"}),"Generating Report..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"📋"}),"Generate Report"]})})})]}),R&&h&&e.jsxs("section",{className:"card preview-section",children:[e.jsxs("div",{className:"preview-header",children:[e.jsxs("h2",{className:"section-title",children:[e.jsx("span",{className:"section-icon",children:"📄"}),"Report Preview"]}),e.jsxs("div",{className:"preview-actions",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>C(!1),children:"Close Preview"}),e.jsxs("button",{className:"btn btn-success",onClick:k,children:[e.jsx("span",{children:"📥"}),"Export PDF"]})]})]}),e.jsx("div",{className:"preview-container",children:e.jsx(L,{report:h})})]}),y.show&&e.jsx("div",{className:`toast show ${y.type}`,children:y.message})]})};export{F as default};
