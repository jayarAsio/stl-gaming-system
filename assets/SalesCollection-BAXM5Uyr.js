import{r as t,j as s,L as Y}from"./index-ttmfNWme.js";const Q=[{id:"T001",name:"Juan Dela Cruz",code:"TLR001",location:"Booth A1",totalSales:25420,totalWinners:8650,surplus:16770,commission:1271,netCollection:15499,ticketsSold:87,winningTickets:5,status:"ready_collection",lastCollection:"2025-01-14 09:30 AM",contactNumber:"09171234567"},{id:"T002",name:"Maria Santos",code:"TLR002",location:"Booth B2",totalSales:18150,totalWinners:12200,surplus:5950,commission:907.5,netCollection:5042.5,ticketsSold:134,winningTickets:8,status:"collected",lastCollection:"2025-01-15 12:30 PM",contactNumber:"09281234567"},{id:"T003",name:"Pedro Garcia",code:"TLR003",location:"Booth C3",totalSales:32750,totalWinners:18900,surplus:13850,commission:1637.5,netCollection:12212.5,ticketsSold:92,winningTickets:12,status:"ready_collection",lastCollection:"2025-01-14 10:15 AM",contactNumber:"09391234567"},{id:"T004",name:"Ana Reyes",code:"TLR004",location:"Booth D4",totalSales:28200,totalWinners:15600,surplus:12600,commission:1410,netCollection:11190,ticketsSold:156,winningTickets:18,status:"ready_collection",lastCollection:"2025-01-14 07:30 AM",contactNumber:"09401234567"},{id:"T005",name:"Carlos Lopez",code:"TLR005",location:"Booth E5",totalSales:22890,totalWinners:4250,surplus:18640,commission:1144.5,netCollection:17495.5,ticketsSold:73,winningTickets:3,status:"collected",lastCollection:"2025-01-15 11:00 AM",contactNumber:"09511234567"},{id:"T006",name:"Rosa Martinez",code:"TLR006",location:"Booth F6",totalSales:15600,totalWinners:15600,surplus:0,commission:780,netCollection:0,ticketsSold:45,winningTickets:12,status:"balanced",lastCollection:"2025-01-13 02:15 PM",contactNumber:"09621234567"},{id:"T007",name:"Miguel Fernandez",code:"TLR007",location:"Booth G7",totalSales:2850,totalWinners:0,surplus:2850,commission:142.5,netCollection:2707.5,ticketsSold:12,winningTickets:0,status:"ready_collection",lastCollection:"2025-01-12 04:30 PM",contactNumber:"09731234567"},{id:"T008",name:"Elena Gonzalez",code:"TLR008",location:"Booth H8",totalSales:0,totalWinners:0,surplus:0,commission:0,netCollection:0,ticketsSold:0,winningTickets:0,status:"no_activity",lastCollection:"2025-01-10 11:45 AM",contactNumber:"09841234567"},{id:"T009",name:"Lisa Santos",code:"TLR009",location:"Booth I9",totalSales:1250,totalWinners:850,surplus:400,commission:62.5,netCollection:337.5,ticketsSold:8,winningTickets:2,status:"ready_collection",lastCollection:"2025-01-13 09:10 AM",contactNumber:"09061234567"}],J=[{id:"COL001",tellerId:"T002",tellerName:"Maria Santos",surplusAmount:5950,commissionDeducted:907.5,netCollected:5042.5,collectedAt:"2025-01-15 12:30 PM",collectedBy:"Collector C001",notes:"Surplus collection after winner payouts - verified cash count"},{id:"COL002",tellerId:"T005",tellerName:"Carlos Lopez",surplusAmount:18640,commissionDeducted:1144.5,netCollected:17495.5,collectedAt:"2025-01-15 12:45 PM",collectedBy:"Collector C001",notes:"Large surplus collection - minimal winners today"}],K=()=>{const[n,L]=t.useState(Q),[S,A]=t.useState(J),[u,M]=t.useState(""),[x,B]=t.useState("ready_collection"),[o,T]=t.useState(null),[F,f]=t.useState(!1),[h,v]=t.useState(""),[j,p]=t.useState(""),[C,w]=t.useState(!1),[y,k]=t.useState({show:!1,message:"",type:"success"}),[V,R]=t.useState(new Date);t.useEffect(()=>{const e=setInterval(()=>{R(new Date)},1e3);return()=>clearInterval(e)},[]),t.useEffect(()=>(document.body.classList.add("sales-collection-bg"),()=>document.body.classList.remove("sales-collection-bg")),[]);const l=new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",maximumFractionDigits:2}),g=t.useCallback((e,a="success")=>{k({show:!0,message:e,type:a}),setTimeout(()=>k(i=>({...i,show:!1})),4e3)},[]),r=t.useMemo(()=>{const e=n.filter(c=>c.status==="ready_collection"),a=n.filter(c=>c.status==="collected"),i=n.filter(c=>c.status==="balanced"),m=n.filter(c=>c.status==="no_activity"),H=n.reduce((c,d)=>c+d.surplus,0),O=n.reduce((c,d)=>c+d.commission,0),$=n.reduce((c,d)=>c+d.netCollection,0),z=a.reduce((c,d)=>c+d.netCollection,0),G=e.reduce((c,d)=>c+d.netCollection,0);return{totalTellers:n.length,readyCount:e.length,collectedCount:a.length,balancedCount:i.length,noActivityCount:m.length,totalSurplus:H,totalCommission:O,totalNetCollection:$,collectedAmount:z,pendingAmount:G,collectionRate:n.length>0?(a.length/n.length*100).toFixed(1):0}},[n]),b=t.useMemo(()=>n.filter(e=>{const a=u===""||e.name.toLowerCase().includes(u.toLowerCase())||e.code.toLowerCase().includes(u.toLowerCase())||e.location.toLowerCase().includes(u.toLowerCase()),i=x==="all"||e.status===x;return a&&i}),[n,u,x]),D=t.useCallback(e=>{T(e),v(e.netCollection.toString()),p(""),f(!0)},[]),N=t.useCallback(()=>{f(!1),T(null),v(""),p("")},[]),P=t.useCallback(async()=>{if(!o||!h)return;const e=parseFloat(h);if(isNaN(e)||e<=0){g("Please enter a valid collection amount","error");return}w(!0),setTimeout(()=>{const a={id:`COL${Date.now().toString().slice(-6)}`,tellerId:o.id,tellerName:o.name,surplusAmount:o.surplus,commissionDeducted:o.commission,netCollected:e,collectedAt:new Date().toLocaleString("en-PH",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}),collectedBy:"Collector C001",notes:j||"Surplus collection after winner payouts"};L(i=>i.map(m=>m.id===o.id?{...m,status:"collected",lastCollection:a.collectedAt}:m)),A(i=>[a,...i]),w(!1),N(),g(`Surplus collected: ${l.format(e)} from ${o.name}`,"success")},1200)},[o,h,j,l,g,N]),_=e=>{const a={ready_collection:{class:"status-ready",text:"READY FOR COLLECTION",icon:"ðŸ’°"},collected:{class:"status-collected",text:"COLLECTED",icon:"âœ…"},balanced:{class:"status-balanced",text:"BALANCED",icon:"âš–ï¸"},no_activity:{class:"status-no-activity",text:"NO ACTIVITY",icon:"ðŸš«"}};return a[e]||a.ready_collection},W=()=>s.jsxs("div",{className:"statistics-grid",children:[s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-value",children:r.totalTellers}),s.jsx("div",{className:"stat-label",children:"Total Tellers"})]}),s.jsxs("div",{className:"stat-card pending",children:[s.jsx("div",{className:"stat-value",children:r.readyCount}),s.jsx("div",{className:"stat-label",children:"Ready Collection"})]}),s.jsxs("div",{className:"stat-card collected",children:[s.jsx("div",{className:"stat-value",children:r.collectedCount}),s.jsx("div",{className:"stat-label",children:"Collected Today"})]}),s.jsxs("div",{className:"stat-card rate",children:[s.jsxs("div",{className:"stat-value",children:[r.collectionRate,"%"]}),s.jsx("div",{className:"stat-label",children:"Collection Rate"})]})]}),I=({teller:e})=>{const a=_(e.status),i=e.status==="ready_collection",m=e.surplus>2e4;return s.jsxs("article",{className:`teller-item ${e.status} ${m?"high-value":""}`,children:[s.jsxs("div",{className:"teller-header",children:[s.jsxs("div",{className:"teller-info",children:[s.jsx("div",{className:"teller-name",children:e.name}),s.jsxs("div",{className:"teller-meta",children:[s.jsx("span",{className:"teller-code",children:e.code}),s.jsx("span",{className:"teller-location",children:e.location})]})]}),s.jsxs("div",{className:`teller-status ${a.class}`,children:[s.jsx("span",{className:"status-icon",children:a.icon}),s.jsx("span",{className:"status-text",children:a.text})]})]}),s.jsxs("div",{className:"teller-stats",children:[s.jsxs("div",{className:"stat-row",children:[s.jsxs("div",{className:"stat",children:[s.jsx("div",{className:"stat-label",children:"Total Sales"}),s.jsx("div",{className:"stat-value",children:l.format(e.totalSales)})]}),s.jsxs("div",{className:"stat",children:[s.jsx("div",{className:"stat-label",children:"Winner Payouts"}),s.jsx("div",{className:"stat-value winners",children:l.format(e.totalWinners)})]})]}),s.jsxs("div",{className:"stat-row",children:[s.jsxs("div",{className:"stat",children:[s.jsx("div",{className:"stat-label",children:"Tickets Sold"}),s.jsx("div",{className:"stat-value",children:e.ticketsSold.toLocaleString()})]}),s.jsxs("div",{className:"stat",children:[s.jsx("div",{className:"stat-label",children:"Winning Tickets"}),s.jsx("div",{className:"stat-value winning-count",children:e.winningTickets.toLocaleString()})]})]}),(i||e.status==="collected")&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"stat-row",children:[s.jsxs("div",{className:"stat",children:[s.jsx("div",{className:"stat-label",children:"Gross Surplus"}),s.jsx("div",{className:"stat-value surplus",children:l.format(e.surplus)})]}),s.jsxs("div",{className:"stat",children:[s.jsx("div",{className:"stat-label",children:"Commission"}),s.jsx("div",{className:"stat-value commission",children:l.format(e.commission)})]})]}),s.jsxs("div",{className:"collection-row",children:[s.jsx("div",{className:"collection-label",children:"Net Collection Amount"}),s.jsx("div",{className:"collection-amount",children:l.format(e.netCollection)})]})]})]}),s.jsxs("div",{className:"teller-footer",children:[s.jsxs("div",{className:"last-collection",children:["Last Collection: ",e.lastCollection]}),i&&s.jsxs("button",{className:`btn btn-collect ${m?"high-value":""}`,onClick:()=>D(e),children:[s.jsx("span",{className:"btn-icon",children:"ðŸ’°"}),"Collect Surplus"]})]})]})},E=({collection:e})=>s.jsxs("article",{className:"history-item",children:[s.jsxs("div",{className:"history-header",children:[s.jsxs("div",{className:"history-info",children:[s.jsxs("div",{className:"history-id",children:["#",e.id]}),s.jsx("div",{className:"history-teller",children:e.tellerName})]}),s.jsx("div",{className:"history-amount",children:l.format(e.netCollected)})]}),s.jsxs("div",{className:"history-breakdown",children:[s.jsxs("div",{className:"breakdown-item",children:[s.jsx("span",{children:"Gross Surplus:"}),s.jsx("span",{children:l.format(e.surplusAmount)})]}),s.jsxs("div",{className:"breakdown-item",children:[s.jsx("span",{children:"Commission Deducted:"}),s.jsxs("span",{className:"commission",children:["-",l.format(e.commissionDeducted)]})]}),s.jsxs("div",{className:"breakdown-item total",children:[s.jsx("span",{children:"Net Collected:"}),s.jsx("span",{children:l.format(e.netCollected)})]})]}),s.jsxs("div",{className:"history-details",children:[s.jsx("div",{className:"history-time",children:e.collectedAt}),s.jsxs("div",{className:"history-collector",children:["by ",e.collectedBy]})]}),e.notes&&s.jsx("div",{className:"history-notes",children:e.notes})]});return s.jsxs("div",{className:"container",children:[s.jsxs("header",{className:"header",children:[s.jsxs("div",{className:"header-content",children:[s.jsx("h1",{children:"Sales Collection"}),s.jsx("p",{className:"header-subtitle",children:"Collect surplus amounts from tellers after winner payouts"})]}),s.jsxs(Y,{to:"/collector",className:"back-btn","aria-label":"Back to Dashboard",children:[s.jsx("span",{"aria-hidden":"true",children:"â†"})," Back To Dashboard"]})]}),s.jsxs("section",{className:"card statistics-section",children:[s.jsxs("h2",{className:"section-title",children:[s.jsx("span",{className:"section-icon",children:"ðŸ“Š"}),"Collection Summary"]}),s.jsx(W,{}),s.jsxs("div",{className:"summary-details",children:[s.jsxs("div",{className:"summary-row",children:[s.jsx("span",{children:"Total Gross Surplus"}),s.jsx("span",{className:"amount",children:l.format(r.totalSurplus)})]}),s.jsxs("div",{className:"summary-row",children:[s.jsx("span",{children:"Total Commission"}),s.jsx("span",{className:"amount commission",children:l.format(r.totalCommission)})]}),s.jsxs("div",{className:"summary-row",children:[s.jsx("span",{children:"Net Collection Due"}),s.jsx("span",{className:"amount",children:l.format(r.totalNetCollection)})]}),s.jsxs("div",{className:"summary-row",children:[s.jsx("span",{children:"Amount Collected"}),s.jsx("span",{className:"amount collected",children:l.format(r.collectedAmount)})]}),s.jsxs("div",{className:"summary-row",children:[s.jsx("span",{children:"Amount Pending"}),s.jsx("span",{className:"amount pending",children:l.format(r.pendingAmount)})]})]})]}),s.jsxs("section",{className:"card controls-section",children:[s.jsxs("h2",{className:"section-title",children:[s.jsx("span",{className:"section-icon",children:"ðŸ”"}),"Search & Filter"]}),s.jsxs("div",{className:"controls-grid",children:[s.jsxs("div",{className:"control-group",children:[s.jsx("label",{htmlFor:"search",className:"control-label",children:"Search Tellers"}),s.jsx("input",{id:"search",type:"text",className:"control-input",placeholder:"Search by name, code, or location...",value:u,onChange:e=>M(e.target.value)})]}),s.jsxs("div",{className:"control-group",children:[s.jsx("label",{htmlFor:"status-filter",className:"control-label",children:"Filter by Status"}),s.jsxs("select",{id:"status-filter",className:"control-select",value:x,onChange:e=>B(e.target.value),children:[s.jsx("option",{value:"all",children:"All Statuses"}),s.jsx("option",{value:"ready_collection",children:"Ready for Collection"}),s.jsx("option",{value:"collected",children:"Collected"}),s.jsx("option",{value:"balanced",children:"Balanced"}),s.jsx("option",{value:"no_activity",children:"No Activity"})]})]})]})]}),s.jsxs("section",{className:"card tellers-section",children:[s.jsxs("h2",{className:"section-title",children:[s.jsx("span",{className:"section-icon",children:"ðŸ‘¥"}),"Tellers with Surplus (",b.length,")"]}),b.length===0?s.jsxs("div",{className:"empty-state",children:[s.jsx("div",{className:"empty-icon",children:"ðŸ”"}),s.jsx("div",{className:"empty-title",children:"No Tellers Found"}),s.jsx("div",{className:"empty-text",children:"Try adjusting your search criteria or filters."})]}):s.jsx("div",{className:"tellers-grid",children:b.map(e=>s.jsx(I,{teller:e},e.id))})]}),s.jsxs("section",{className:"card history-section",children:[s.jsxs("h2",{className:"section-title",children:[s.jsx("span",{className:"section-icon",children:"ðŸ“‹"}),"Collection History"]}),S.length===0?s.jsxs("div",{className:"empty-state",children:[s.jsx("div",{className:"empty-icon",children:"ðŸ“‹"}),s.jsx("div",{className:"empty-title",children:"No Collections Yet"}),s.jsx("div",{className:"empty-text",children:"Collection records will appear here after you collect surplus amounts."})]}):s.jsx("div",{className:"history-grid",children:S.map(e=>s.jsx(E,{collection:e},e.id))})]}),F&&o&&s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h3",{children:"Collect Surplus"}),s.jsx("button",{className:"modal-close",onClick:N,"aria-label":"Close modal",children:"Ã—"})]}),s.jsxs("div",{className:"modal-body",children:[s.jsxs("div",{className:"teller-summary",children:[s.jsxs("h4",{children:[o.name," (",o.code,")"]}),s.jsxs("div",{className:"summary-grid",children:[s.jsxs("div",{className:"summary-item",children:[s.jsx("span",{children:"Total Sales"}),s.jsx("span",{children:l.format(o.totalSales)})]}),s.jsxs("div",{className:"summary-item",children:[s.jsx("span",{children:"Winner Payouts"}),s.jsx("span",{children:l.format(o.totalWinners)})]}),s.jsxs("div",{className:"summary-item",children:[s.jsx("span",{children:"Gross Surplus"}),s.jsx("span",{className:"surplus",children:l.format(o.surplus)})]}),s.jsxs("div",{className:"summary-item",children:[s.jsx("span",{children:"Commission (5%)"}),s.jsxs("span",{className:"commission",children:["-",l.format(o.commission)]})]}),s.jsxs("div",{className:"summary-item",children:[s.jsx("span",{children:"Net Collection"}),s.jsx("span",{className:"highlight",children:l.format(o.netCollection)})]})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"collection-amount",className:"form-label",children:"Collection Amount"}),s.jsx("input",{id:"collection-amount",type:"number",step:"0.01",min:"0",className:"form-input",value:h,onChange:e=>v(e.target.value)}),s.jsx("div",{className:"form-help",children:"Enter the actual surplus amount collected from the teller."})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"collection-notes",className:"form-label",children:"Notes (Optional)"}),s.jsx("textarea",{id:"collection-notes",className:"form-textarea",placeholder:"Add any notes about this collection...",value:j,onChange:e=>p(e.target.value),maxLength:500}),s.jsxs("div",{className:"form-help",children:[j.length,"/500 characters"]})]})]}),s.jsxs("div",{className:"modal-footer",children:[s.jsx("button",{className:"btn btn-secondary",onClick:N,disabled:C,children:"Cancel"}),s.jsx("button",{className:"btn btn-primary",onClick:P,disabled:C||!h,children:C?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner"}),"Processing..."]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{children:"ðŸ’°"}),"Complete Collection"]})})]})]})}),y.show&&s.jsx("div",{className:`toast show ${y.type}`,children:y.message})]})};export{K as default};
