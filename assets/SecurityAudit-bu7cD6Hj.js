import{r as c,j as s}from"./index-BVvE27mP.js";const U=()=>{const[t,o]=c.useState("audit"),[i,n]=c.useState({dateFrom:new Date().toISOString().split("T")[0],dateTo:new Date().toISOString().split("T")[0],user:"all",action:"all",search:""}),[a,v]=c.useState(null),[g,r]=c.useState(!1),f=()=>{const e=j(),l=new Date().toISOString().split("T")[0],S=`security_audit_${t}_${l}.csv`;alert(`Exporting ${e.length} ${t} logs as CSV
Filename: ${S}`)},b=()=>{if(!a)return;const e=`log_${a.id}_${new Date().toISOString().split("T")[0]}.json`;alert(`Exporting log ${a.id}
Filename: ${e}`)},C=()=>{if(!a)return;const e=prompt(`Add note to log ${a.id}:`);e&&alert(`Note added to ${a.id}:
"${e}"`)},y=()=>{alert(`Refreshing logs...
In production: Fetch latest data from server`)},A=()=>{n({dateFrom:new Date().toISOString().split("T")[0],dateTo:new Date().toISOString().split("T")[0],user:"all",action:"all",search:""})},u=[{id:"AUD-001",timestamp:"2025-10-24 10:45:23",user:"Juan Dela Cruz",userId:"U-0045",role:"Admin",action:"Updated Game Settings",category:"configuration",resource:"STL Pares Configuration",details:"Changed payout multiplier from 650 to 700",ipAddress:"192.168.1.100",deviceInfo:"Chrome 118 / Windows 10",status:"success",changes:{before:{payoutMultiplier:650},after:{payoutMultiplier:700}}},{id:"AUD-002",timestamp:"2025-10-24 10:30:15",user:"Maria Santos",userId:"U-0023",role:"Teller Manager",action:"Created User Account",category:"user_management",resource:"User: T-0156",details:"Created new teller account for Pedro Garcia",ipAddress:"192.168.1.105",deviceInfo:"Firefox 119 / Windows 11",status:"success",changes:{created:{username:"T-0156",role:"Teller"}}},{id:"AUD-003",timestamp:"2025-10-24 10:15:08",user:"Carlos Reyes",userId:"U-0089",role:"Super Admin",action:"Modified Bet Limits",category:"configuration",resource:"Global Bet Limits",details:"Updated maximum bet limit for Last 2 game",ipAddress:"192.168.1.110",deviceInfo:"Edge 118 / Windows 10",status:"success",changes:{before:{maxBet:1500},after:{maxBet:2e3}}},{id:"AUD-004",timestamp:"2025-10-24 09:55:42",user:"Ana Garcia",userId:"U-0034",role:"Auditor",action:"Exported Transaction Report",category:"reports",resource:"Daily Transaction Report",details:"Exported transactions for 2025-10-23",ipAddress:"192.168.1.112",deviceInfo:"Chrome 118 / macOS 14",status:"success",changes:null},{id:"AUD-005",timestamp:"2025-10-24 09:40:18",user:"Roberto Cruz",userId:"U-0067",role:"Admin",action:"Failed Login Attempt",category:"authentication",resource:"Login System",details:"Invalid password entered",ipAddress:"192.168.1.150",deviceInfo:"Chrome 118 / Android 13",status:"failed",changes:null}],m=[{id:"SEC-001",timestamp:"2025-10-24 11:15:30",severity:"high",type:"unauthorized_access",user:"Unknown",description:"Failed admin login from unusual location",ipAddress:"203.145.67.89",location:"Unknown Location",action:"Blocked",status:"blocked"},{id:"SEC-002",timestamp:"2025-10-24 10:45:18",severity:"medium",type:"suspicious_activity",user:"T-0045",description:"Multiple rapid transactions detected",ipAddress:"192.168.1.156",location:"Terminal Area-08",action:"Flagged for review",status:"investigating"},{id:"SEC-003",timestamp:"2025-10-24 10:20:45",severity:"critical",type:"data_access",user:"U-0089",description:"Bulk data export attempted",ipAddress:"192.168.1.110",location:"Admin Office",action:"Logged and notified",status:"resolved"},{id:"SEC-004",timestamp:"2025-10-24 09:55:12",severity:"low",type:"password_change",user:"U-0034",description:"Password successfully changed",ipAddress:"192.168.1.112",location:"Office Network",action:"Logged",status:"success"}],N=[{id:"ACC-001",timestamp:"2025-10-24 11:30:22",user:"Juan Dela Cruz",userId:"U-0045",action:"Logged In",ipAddress:"192.168.1.100",location:"Main Office",device:"Chrome / Windows 10",sessionDuration:"Active",status:"active"},{id:"ACC-002",timestamp:"2025-10-24 11:15:45",user:"Maria Santos",userId:"U-0023",action:"Logged In",ipAddress:"192.168.1.105",location:"Branch Office",device:"Firefox / Windows 11",sessionDuration:"Active",status:"active"},{id:"ACC-003",timestamp:"2025-10-24 10:45:30",user:"Carlos Reyes",userId:"U-0089",action:"Logged Out",ipAddress:"192.168.1.110",location:"Admin Office",device:"Edge / Windows 10",sessionDuration:"2h 15m",status:"completed"},{id:"ACC-004",timestamp:"2025-10-24 10:30:18",user:"Unknown User",userId:"N/A",action:"Failed Login",ipAddress:"203.145.67.89",location:"Unknown",device:"Unknown",sessionDuration:"N/A",status:"failed"}],j=()=>(t==="audit"?u:t==="security"?m:N).filter(l=>i.search===""||JSON.stringify(l).toLowerCase().includes(i.search.toLowerCase())),h=c.useMemo(()=>j(),[t,i]),d=c.useMemo(()=>({auditCount:u.length,securityCount:m.length,accessCount:N.length,failedLogins:u.filter(e=>e.status==="failed").length,criticalEvents:m.filter(e=>e.severity==="critical").length}),[]),p=e=>{v(e),r(!0)},x=e=>({success:"secaudit-status-success",failed:"secaudit-status-failed",blocked:"secaudit-status-blocked",active:"secaudit-status-active",completed:"secaudit-status-completed",investigating:"secaudit-status-investigating",resolved:"secaudit-status-resolved"})[e]||"secaudit-status-default",w=e=>({critical:"secaudit-severity-critical",high:"secaudit-severity-high",medium:"secaudit-severity-medium",low:"secaudit-severity-low"})[e]||"secaudit-severity-low";return s.jsxs("div",{className:"secaudit-container",children:[s.jsxs("div",{className:"secaudit-page-header",children:[s.jsxs("div",{className:"secaudit-header-text",children:[s.jsx("h1",{className:"secaudit-page-title",children:"Security & Audit"}),s.jsx("p",{className:"secaudit-page-subtitle",children:"Monitor system activity, security events, and access logs"})]}),s.jsx("div",{className:"secaudit-header-actions",children:s.jsx("button",{className:"secaudit-refresh-btn",onClick:y,children:"ğŸ”„ Refresh"})})]}),s.jsxs("div",{className:"secaudit-stats-grid",children:[s.jsxs("div",{className:"secaudit-stat-box",children:[s.jsx("div",{className:"secaudit-stat-icon secaudit-icon-blue",children:"ğŸ“‹"}),s.jsxs("div",{className:"secaudit-stat-content",children:[s.jsx("div",{className:"secaudit-stat-number",children:d.auditCount}),s.jsx("div",{className:"secaudit-stat-text",children:"Audit Logs"})]})]}),s.jsxs("div",{className:"secaudit-stat-box",children:[s.jsx("div",{className:"secaudit-stat-icon secaudit-icon-red",children:"ğŸ”’"}),s.jsxs("div",{className:"secaudit-stat-content",children:[s.jsx("div",{className:"secaudit-stat-number",children:d.securityCount}),s.jsx("div",{className:"secaudit-stat-text",children:"Security Events"})]})]}),s.jsxs("div",{className:"secaudit-stat-box",children:[s.jsx("div",{className:"secaudit-stat-icon secaudit-icon-green",children:"ğŸ‘¥"}),s.jsxs("div",{className:"secaudit-stat-content",children:[s.jsx("div",{className:"secaudit-stat-number",children:d.accessCount}),s.jsx("div",{className:"secaudit-stat-text",children:"Access Logs"})]})]}),s.jsxs("div",{className:"secaudit-stat-box",children:[s.jsx("div",{className:"secaudit-stat-icon secaudit-icon-orange",children:"âš ï¸"}),s.jsxs("div",{className:"secaudit-stat-content",children:[s.jsx("div",{className:"secaudit-stat-number",children:d.failedLogins}),s.jsx("div",{className:"secaudit-stat-text",children:"Failed Logins"})]})]}),s.jsxs("div",{className:"secaudit-stat-box",children:[s.jsx("div",{className:"secaudit-stat-icon secaudit-icon-purple",children:"ğŸ”´"}),s.jsxs("div",{className:"secaudit-stat-content",children:[s.jsx("div",{className:"secaudit-stat-number",children:d.criticalEvents}),s.jsx("div",{className:"secaudit-stat-text",children:"Critical Events"})]})]})]}),s.jsxs("div",{className:"secaudit-tabs-wrapper",children:[s.jsx("button",{className:`secaudit-tab-button ${t==="audit"?"secaudit-tab-active":""}`,onClick:()=>o("audit"),children:"ğŸ“‹ Audit Trail"}),s.jsx("button",{className:`secaudit-tab-button ${t==="security"?"secaudit-tab-active":""}`,onClick:()=>o("security"),children:"ğŸ”’ Security Events"}),s.jsx("button",{className:`secaudit-tab-button ${t==="access"?"secaudit-tab-active":""}`,onClick:()=>o("access"),children:"ğŸ‘¥ Access Logs"})]}),s.jsxs("div",{className:"secaudit-filters-bar",children:[s.jsxs("div",{className:"secaudit-filter-item secaudit-search-filter",children:[s.jsx("label",{className:"secaudit-filter-label",children:"Search"}),s.jsx("input",{type:"text",className:"secaudit-filter-input",placeholder:"Search logs...",value:i.search,onChange:e=>n({...i,search:e.target.value})})]}),s.jsxs("div",{className:"secaudit-filter-item",children:[s.jsx("label",{className:"secaudit-filter-label",children:"From Date"}),s.jsx("input",{type:"date",className:"secaudit-filter-input",value:i.dateFrom,onChange:e=>n({...i,dateFrom:e.target.value})})]}),s.jsxs("div",{className:"secaudit-filter-item",children:[s.jsx("label",{className:"secaudit-filter-label",children:"To Date"}),s.jsx("input",{type:"date",className:"secaudit-filter-input",value:i.dateTo,onChange:e=>n({...i,dateTo:e.target.value})})]}),s.jsxs("div",{className:"secaudit-filter-item secaudit-filter-buttons",children:[s.jsx("button",{className:"secaudit-clear-btn",onClick:A,children:"ğŸ—‘ï¸ Clear"}),s.jsx("button",{className:"secaudit-export-btn",onClick:f,children:"ğŸ“¥ Export"})]})]}),s.jsxs("div",{className:"secaudit-content-area",children:[t==="audit"&&s.jsx("div",{className:"secaudit-logs-container",children:h.map(e=>s.jsxs("div",{className:"secaudit-log-item",children:[s.jsxs("div",{className:"secaudit-log-top",children:[s.jsxs("div",{className:"secaudit-log-meta-top",children:[s.jsx("span",{className:"secaudit-log-identifier",children:e.id}),s.jsxs("span",{className:"secaudit-log-timestamp",children:["â° ",e.timestamp]})]}),s.jsx("span",{className:`secaudit-badge ${x(e.status)}`,children:e.status.toUpperCase()})]}),s.jsxs("div",{className:"secaudit-log-main",children:[s.jsx("div",{className:"secaudit-log-icon-wrapper",children:"ğŸ“"}),s.jsxs("div",{className:"secaudit-log-details",children:[s.jsx("h3",{className:"secaudit-log-heading",children:e.action}),s.jsx("p",{className:"secaudit-log-text",children:e.details}),s.jsxs("div",{className:"secaudit-log-metadata",children:[s.jsxs("span",{className:"secaudit-meta-tag",children:["ğŸ‘¤ ",e.user]}),s.jsxs("span",{className:"secaudit-meta-tag",children:["ğŸ·ï¸ ",e.category]}),s.jsxs("span",{className:"secaudit-meta-tag",children:["ğŸ’» ",e.ipAddress]})]})]})]}),s.jsx("div",{className:"secaudit-log-footer",children:s.jsx("button",{className:"secaudit-view-btn",onClick:()=>p(e),children:"View Details"})})]},e.id))}),t==="security"&&s.jsx("div",{className:"secaudit-logs-container",children:h.map(e=>s.jsxs("div",{className:"secaudit-log-item",children:[s.jsxs("div",{className:"secaudit-log-top",children:[s.jsxs("div",{className:"secaudit-log-meta-top",children:[s.jsx("span",{className:"secaudit-log-identifier",children:e.id}),s.jsx("span",{className:`secaudit-badge ${w(e.severity)}`,children:e.severity.toUpperCase()})]}),s.jsx("span",{className:`secaudit-badge ${x(e.status)}`,children:e.status.toUpperCase()})]}),s.jsxs("div",{className:"secaudit-log-main",children:[s.jsx("div",{className:"secaudit-log-icon-wrapper",children:"ğŸ”’"}),s.jsxs("div",{className:"secaudit-log-details",children:[s.jsx("h3",{className:"secaudit-log-heading",children:e.description}),s.jsxs("p",{className:"secaudit-log-text",children:["Action taken: ",e.action]}),s.jsxs("div",{className:"secaudit-log-metadata",children:[s.jsxs("span",{className:"secaudit-meta-tag",children:["ğŸ‘¤ ",e.user]}),s.jsxs("span",{className:"secaudit-meta-tag",children:["ğŸ“ ",e.location]}),s.jsxs("span",{className:"secaudit-meta-tag",children:["ğŸ’» ",e.ipAddress]})]})]})]}),s.jsx("div",{className:"secaudit-log-footer",children:s.jsx("button",{className:"secaudit-view-btn",onClick:()=>p(e),children:"View Details"})})]},e.id))}),t==="access"&&s.jsx("div",{className:"secaudit-logs-container",children:h.map(e=>s.jsxs("div",{className:"secaudit-log-item",children:[s.jsxs("div",{className:"secaudit-log-top",children:[s.jsxs("div",{className:"secaudit-log-meta-top",children:[s.jsx("span",{className:"secaudit-log-identifier",children:e.id}),s.jsxs("span",{className:"secaudit-log-timestamp",children:["â° ",e.timestamp]})]}),s.jsx("span",{className:`secaudit-badge ${x(e.status)}`,children:e.status.toUpperCase()})]}),s.jsxs("div",{className:"secaudit-log-main",children:[s.jsx("div",{className:"secaudit-log-icon-wrapper",children:"ğŸ‘¥"}),s.jsxs("div",{className:"secaudit-log-details",children:[s.jsxs("h3",{className:"secaudit-log-heading",children:[e.action," - ",e.user]}),s.jsxs("p",{className:"secaudit-log-text",children:["Session: ",e.sessionDuration]}),s.jsxs("div",{className:"secaudit-log-metadata",children:[s.jsxs("span",{className:"secaudit-meta-tag",children:["ğŸ†” ",e.userId]}),s.jsxs("span",{className:"secaudit-meta-tag",children:["ğŸ“ ",e.location]}),s.jsxs("span",{className:"secaudit-meta-tag",children:["ğŸ’» ",e.ipAddress]})]})]})]}),s.jsx("div",{className:"secaudit-log-footer",children:s.jsx("button",{className:"secaudit-view-btn",onClick:()=>p(e),children:"View Details"})})]},e.id))})]}),g&&a&&s.jsxs("div",{className:"secaudit-modal-overlay",children:[s.jsx("div",{className:"secaudit-modal-backdrop",onClick:()=>r(!1)}),s.jsxs("div",{className:`secaudit-side-panel ${g?"secaudit-panel-visible":""}`,children:[s.jsxs("div",{className:"secaudit-panel-header",children:[s.jsxs("h3",{className:"secaudit-panel-title",children:["Log Details - ",a.id]}),s.jsx("button",{className:"secaudit-panel-close",onClick:()=>r(!1),children:"Ã—"})]}),s.jsxs("div",{className:"secaudit-panel-body",children:[s.jsxs("div",{className:"secaudit-info-section",children:[s.jsx("h4",{className:"secaudit-info-title",children:"General Information"}),s.jsxs("div",{className:"secaudit-info-grid",children:[s.jsxs("div",{className:"secaudit-info-field",children:[s.jsx("span",{className:"secaudit-field-label",children:"ID"}),s.jsx("span",{className:"secaudit-field-value",children:a.id})]}),s.jsxs("div",{className:"secaudit-info-field",children:[s.jsx("span",{className:"secaudit-field-label",children:"Timestamp"}),s.jsx("span",{className:"secaudit-field-value",children:a.timestamp})]}),a.user&&s.jsxs("div",{className:"secaudit-info-field",children:[s.jsx("span",{className:"secaudit-field-label",children:"User"}),s.jsx("span",{className:"secaudit-field-value",children:a.user})]}),a.ipAddress&&s.jsxs("div",{className:"secaudit-info-field",children:[s.jsx("span",{className:"secaudit-field-label",children:"IP Address"}),s.jsx("span",{className:"secaudit-field-value",children:a.ipAddress})]})]})]}),a.changes&&s.jsxs("div",{className:"secaudit-info-section",children:[s.jsx("h4",{className:"secaudit-info-title",children:"Changes Made"}),s.jsx("div",{className:"secaudit-code-block",children:s.jsx("pre",{className:"secaudit-code-text",children:JSON.stringify(a.changes,null,2)})})]})]}),s.jsxs("div",{className:"secaudit-panel-footer",children:[s.jsx("button",{className:"secaudit-action-btn secaudit-btn-cancel",onClick:()=>r(!1),children:"Close"}),s.jsx("button",{className:"secaudit-action-btn secaudit-btn-note",onClick:C,children:"ğŸ“ Add Note"}),s.jsx("button",{className:"secaudit-action-btn secaudit-btn-download",onClick:b,children:"ğŸ“¥ Export"})]})]})]})]})};export{U as default};
